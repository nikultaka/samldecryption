<?php
ini_set('display_errors', 1);
ini_set('display_startup_errors', 1);
error_reporting(E_ALL);    

require_once __DIR__.'/vendor/autoload.php';      



define("TOOLKIT_PATH", '/var/www/oxygen/php-saml-master/');
require_once TOOLKIT_PATH.'/_toolkit_loader.php';



try {
	$auth = new OneLogin_Saml2_Auth();
	$auth->login();

	$encryptedString = 'PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0
YzpTQU1MOjIuMDphc3NlcnRpb24iIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6
bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIElEPSJwZngyNjAzYTA4NS0w
M2NiLTcxYzgtNzNmMC02OGU0NmRmNWY3MDYiIFZlcnNpb249IjIuMCIgSXNz
dWVJbnN0YW50PSIyMDIxLTA1LTE4VDE4OjQ3OjM3WiIgRGVzdGluYXRpb249
Imh0dHA6Ly9sb2NhbGhvc3Q6ODAwMC9zYW1sMi90ZXN0L2FjcyIgSW5SZXNw
b25zZVRvPSJPTkVMT0dJTl9jMjBkNjZmNmZiMzk0OTFiYjRlYWMxNjBhN2Iw
NTA3M2UyYjI4ZDg1Ij48c2FtbDpJc3N1ZXI+aHR0cHM6Ly9hcHAub25lbG9n
aW4uY29tL3NhbWwvbWV0YWRhdGEvZjRhNDM3ZDktOGEwYy00MTVjLTg3OWIt
YzUxYjVkMmMxMWZkPC9zYW1sOklzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5z
OmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6
U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0
aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIv
PjxkczpTaWduYXR1cmVNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3Lncz
Lm9yZy8yMDAwLzA5L3htbGRzaWcjcnNhLXNoYTEiLz48ZHM6UmVmZXJlbmNl
IFVSST0iI3BmeDI2MDNhMDg1LTAzY2ItNzFjOC03M2YwLTY4ZTQ2ZGY1Zjcw
NiI+PGRzOlRyYW5zZm9ybXM+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0
dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyNlbnZlbG9wZWQtc2ln
bmF0dXJlIi8+PGRzOlRyYW5zZm9ybSBBbGdvcml0aG09Imh0dHA6Ly93d3cu
dzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIvPjwvZHM6VHJhbnNmb3Jt
cz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5v
cmcvMjAwMC8wOS94bWxkc2lnI3NoYTEiLz48ZHM6RGlnZXN0VmFsdWU+Y2Uw
UzFON0VsM29iakk0NjkwRDVFaW5yNzFZPTwvZHM6RGlnZXN0VmFsdWU+PC9k
czpSZWZlcmVuY2U+PC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1
ZT5OL2VSOE5HWUlqMzBTbGRPZyttN3Z5djFVY3NLRTVyY1hUVms3TTNrWk5q
WDhVTDBsQm50WjJuNGhORm0vSFN3aEtyVEMvZHNrYUdtRHI0a2FqL04vNVM1
dlpEU0ZDRmgyOVNBeTNrQW5wQVlrSlpkeVE2ek1pcE1tOThPSWdmN1RNS01m
eUhUbVlLNG5VTWtZNGkwNTVmTG9LRFkzNkZKamwwQ3pTY0ROdG5EaVJqbzI4
NW1yMHF4c21HUGYwc2VxRTMwY212Wm5WWkhOVXlETytSNVRGV1Q2QzJ6aS9B
R1dxUjNXSEF5aWkxNGdzNjJEa2poalJnTmZFTXNURi9oa3N0NlNEMWV5OUxv
RjdGallPLzRPaWxLRjduZTRRc3dneDZOdkcrcUcxdWlsaTBMWEZKVWk3My9Y
cjFNUXUwNk0wY3pReTg0RUpKemFVK1JmVTVMdVE9PTwvZHM6U2lnbmF0dXJl
VmFsdWU+PGRzOktleUluZm8+PGRzOlg1MDlEYXRhPjxkczpYNTA5Q2VydGlm
aWNhdGU+TUlJRDZ6Q0NBdE9nQXdJQkFnSVVTVHRpSzFBSE9ORm05TmxKNDRw
cExCaTRUeUF3RFFZSktvWklodmNOQVFFRkJRQXdTakVWTUJNR0ExVUVDZ3dN
Y0dGc2JHRmthWFZ0YUhWaU1SVXdFd1lEVlFRTERBeFBibVZNYjJkcGJpQkpa
RkF4R2pBWUJnTlZCQU1NRVU5dVpVeHZaMmx1SUVGalkyOTFiblFnTUI0WERU
SXhNRFF4T1RFd016a3dPRm9YRFRJMk1EUXhPVEV3TXprd09Gb3dTakVWTUJN
R0ExVUVDZ3dNY0dGc2JHRmthWFZ0YUhWaU1SVXdFd1lEVlFRTERBeFBibVZN
YjJkcGJpQkpaRkF4R2pBWUJnTlZCQU1NRVU5dVpVeHZaMmx1SUVGalkyOTFi
blFnTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FR
RUF1V1RXeWMxb1k5cUMrM0pnTUVDQ0x1dVZUWEpzell5WHBsVlJzV2htcGRa
bk1SUUh5eUNLQ0hHM3NQbm0zUkozaGNVT2FEWFAyVXJKWkhDRjAxd1BjdzV3
QUk2Q0RIb2ppYllzd05icmpUZU5KOFo4Tjc3Rk1MRlVIRms0L2FDVHN0R3Fk
M2VMeUlIQm1DbTlKa05nd1RVNXlOUEYzL2daZU40K2l4cnVFTzA4TGVlVmdS
VWZOcCtmOVpaRmdNOXRScnlxaHlDUmJWb1BzYzhEVUtJUEVWaTZodzZnWGVp
UXRaSzM0Mm5nWEpSZzdjOC9pZ0VycXJiM1ZmUGRCeTJHVjI5ampmRXFnZnJE
KzJDazdzOHRzSU0ycm1GZWZXTGZObEtqV1BkRlhiYklFbU5MN2p0dHhYTXNn
dVQ1c0lFQzJvVUNYWkZ5citJSVJaODdJdHBOU3dJREFRQUJvNEhJTUlIRk1B
d0dBMVVkRXdFQi93UUNNQUF3SFFZRFZSME9CQllFRklXb3g1ZkFjVWRIeUhC
enZlU25POVYxcFFjaU1JR0ZCZ05WSFNNRWZqQjhnQlNGcU1lWHdIRkhSOGh3
Yzcza3B6dlZkYVVISXFGT3BFd3dTakVWTUJNR0ExVUVDZ3dNY0dGc2JHRmth
WFZ0YUhWaU1SVXdFd1lEVlFRTERBeFBibVZNYjJkcGJpQkpaRkF4R2pBWUJn
TlZCQU1NRVU5dVpVeHZaMmx1SUVGalkyOTFiblFnZ2hSSk8ySXJVQWM0MFdi
MDJVbmppbWtzR0xoUElEQU9CZ05WSFE4QkFmOEVCQU1DQjRBd0RRWUpLb1pJ
aHZjTkFRRUZCUUFEZ2dFQkFFSGhSYUp2UFRlcEVCWkJhWnhOYTJjRXhvbFE1
MktTdVZKbXcxRjJGSDlIaWF3YXlFMEJHR3dvcmNHT09pcFBIZ1VIb20xUmhK
NCttbFpocG1DelNVQTVnaEpOVmZoNGxWYUErSHh4bDBRVDhVRFNNM1NXams4
dVBsZTV6Sk0xREVzTEFqQmxmNDhXUTRIeUIxdXRNNWdEb2QzaEF6TjR0aktO
bkZ6QmNUbFc4RGM5V2lBdmlBWTI0VmNrYXV1R3cwVlc5bURWR0FQREFqcHVW
NGtFK25MdmdUTDFWbXNCV3V3UVNmMjZ3N0pNZ2JwelFuMkw0QXU4R3h6cDgv
VzUxcXp5RWFyQS9XdmpGT3NCbmFORWRRUElnTHJGRWdjZEZCSVpVUnlVNng5
MENUY0VOR25wTU5zMHhNRk05WnBTZkZmSURCTFRvc3haTkNxalcvaEszL1U9
PC9kczpYNTA5Q2VydGlmaWNhdGU+PC9kczpYNTA5RGF0YT48L2RzOktleUlu
Zm8+PC9kczpTaWduYXR1cmU+PHNhbWxwOlN0YXR1cz48c2FtbHA6U3RhdHVz
Q29kZSBWYWx1ZT0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOnN0YXR1
czpTdWNjZXNzIi8+PC9zYW1scDpTdGF0dXM+PHNhbWw6RW5jcnlwdGVkQXNz
ZXJ0aW9uPjx4ZW5jOkVuY3J5cHRlZERhdGEgeG1sbnM6eGVuYz0iaHR0cDov
L3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjIiBUeXBlPSJodHRwOi8vd3d3
LnczLm9yZy8yMDAxLzA0L3htbGVuYyNFbGVtZW50Ij48eGVuYzpFbmNyeXB0
aW9uTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8w
NC94bWxlbmMjYWVzMTI4LWNiYyIvPjxkczpLZXlJbmZvIHhtbG5zOmRzPSJo
dHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48eGVuYzpFbmNy
eXB0ZWRLZXk+PHhlbmM6RW5jcnlwdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0
dHA6Ly93d3cudzMub3JnLzIwMDEvMDQveG1sZW5jI3JzYS1vYWVwLW1nZjFw
Ii8+PHhlbmM6Q2lwaGVyRGF0YT48eGVuYzpDaXBoZXJWYWx1ZT5XMlNqeGRp
Qng1Si9jZVNvSU1OaGdXUUNzOXdiZkh2eFQ1ZXNhZjdIczN0ZGZDWkxRUCtq
R0t0cVE2R1BRRUNmCjNvV0NhTEdJVWtrQ1NRcFliaE1nckVINnhLZWxlWWNq
Y3lnTHF4TXNINDJ1WnJsbm4ydW5RbTVZS0ZpeDV4b08KbjkwUGJTbWhkSHFp
VFlPZkVQdXZ6am1GdDJHaTNtR0RhRyt1RlRXclJzOD08L3hlbmM6Q2lwaGVy
VmFsdWU+PC94ZW5jOkNpcGhlckRhdGE+PC94ZW5jOkVuY3J5cHRlZEtleT48
L2RzOktleUluZm8+PHhlbmM6Q2lwaGVyRGF0YT48eGVuYzpDaXBoZXJWYWx1
ZT5PNVB2MFFpVzloOFJSOHJMWXVRVFpVckRuZzQ1OWNPMURjSWhTQnNwbU44
UzZFV2VNcEJFVlRFbTZsdlo5RlN2CnVCWTgvc2o5ZnQwL21WdWd1TVczNHFz
blByY3FDN3daM1JJUlFYenM3Z2d6K3NnVVpoVm1wN05qVGpNSDJDa3YKKzFx
Z3FiN3JRTDY0NTFYN2k3RWdWR25yMEZaNTRGMU9wZ1ZKRC9DV1ZvRVB6UGsx
d3VIUWd5RlZiZWd5eW9idQpyTStERWxzV0FEUzRJTHZueG13TkxHVnhLQ250
enFJaC9Ham1HNk8rK3RhdDRqSmxIWVYyZFhON1VHRXB1N2xVCmVxRzh5ajQ0
TWcvVUd0a3FOb1ZpcVV5cnZDekNJQ1pQTWVIUmpjZ1llTGMvSWZ6eDJuUnVw
VW1ncW1uYVVTU2cKS3ZLcE9SNm1hU08ya0hLeDM3UzgrcjRCVTFaNnNlMXJV
UjhFNzBQdFdRMmtBdEJ0aFdudEdXcHdNSlJkck9sbwpNUXAwOFJmMDk2ZHpm
UXV1Ulo4KzFONnU5WnFJRFQ4UFBDc2REYTlzQTIxNW05K0taNDFQTkhIbzRk
TGNhNHpOCjFsdnlKMVYzSmFERDlTcUdURUdUQUYrNFZvU0d4aE1QaVpKUEI0
TDVtZ3owalUrNDNUQTBFQis0QjJWU2FiNGQKbFEyWjg0THdNS0VjZ1ViQU5O
SkRBRlIybi8rTGN4RDVqSFdaclBtREIxYjdoMUU4dlVsR2RvSEFVVnd1TjVM
UQowYk9vM3FBMEZxOW96eS84M01oQTFrNGU4NGVVMjRGd05EUlE3Q0F5OFoz
RjNvei93cEJBeEprd295aFlJRzM1CjFVRGlxOE43aVR1QUwyUEJVQXhmeHh6
UFpZak9lclExZ082L1hNTzJwandTZm11YlovUjB3ZlYvWlh4VUVBUTMKSCti
Nm90R0FoSHVVZ3JMTGxpbVNzWEZGWDEva0VxcUJzZDJ6K3Znam5iNEFXMHMz
ZkFCdnJwbXNuUVZBSnhHZAo1cGhKUXU4dGxMTDRKYXp4dzhQK25VZXpYVXNW
aEM1RGgrOThkQy91UUF2dUxXVk1ZQkpMdit4YWhXQWJLVTQrCnY2cjNzZWZj
cHZqZmlOUkxHK1J1MGVjMkhaVkRSSFZsckltU1VpSGY1NjRqOXM0RWR4SDhP
SzlIdjBuUTFrRlEKSnJmb2lSMEtmUWxhSXFIOFpaQ1h2NVloWUtzQXpDK3dx
aTd5cHk4RG5UZVlsYVZpWmFqUHhwQjlNSjBZWFlZUwoyb0dacG4rcUJCU0Mr
K2U4czVwdlFuUkxIM1llanVMVkxZdllzQUJ1UFR2cU5tb2Y4Ris0WlBaY3JZ
UTNCSnJyCnZYRFhKK2RWN0NiTWV1OTNjN3B6SUl1OGdmMEpWZU1kUVMxdHdZ
WkVQWGZmelZRbmNZMU1aTG1WOEZNZSsvWlEKV3NaMlhqQU44WGhINUVXelRV
MmtZdEowd0FETmdvWEQ3a2ZCM2s1akx2WXVYTWRJbkYzM0hmZkRmdGxtMURr
aQpVOTR5dHpGbUp2bFRWeE9OK3NDOVVJTlJYU0l6dm8wU1RWWnhIdEN5dTBu
cmJzNTd6NkRhUlAvOVVsL0Rra1FNClRaS2M0RGsxQnJQUlFZd0FlNlcrZ0d3
TTZISTlmMmlBK2ZxU0cybVNxOFdPOExwa1EydlFhSktDN1NaRXJwRDYKMUpG
M2plVTd2WHlwN1N1RTdZOW1lek8yUnJpMHF1dE9vZW5UeHhOMHZHT3BneDk3
N2pNb1FVTFB1Z2R2OHdJTgp1T2tiNlhzTEFVdnNBZDkrazk5NWpzSzJEaHRH
N1VOWVlmaFc3MmtRRFZma3FqZzR1RGloVG5XOXhsK2hVWDhZCk93dEV1L2Y2
SWQzSzE1emFaSDkrNUhzUGdSdXYydUxpR1RpNmZwUElZZ2JFU2txN05nL1ZX
VzVNL2FBOC9iME4KcTUvR25XMHdJaUhXWWFub2dJQno4NW5VbERwUTAzUnBN
S3BrdldzOHZ3bG1mSjF3dTA0dFMyb1VmNzBXOERldwpBbE52bmxocXlSMEpH
eWJsbG5VQk1FcWc0VUJ6bnF5UWZiaFFWVm00NnZqQlBCR2U1bTVmU3B5WUc4
dWkxcU1YCmRzQWlNMWI4VS9WSjN6eDQybjkweGJMR2VEYzZLNFdkUTZqYTMv
N2ZLbHRLVlp6eUJRNjVESWxRd2o3dk0vY2wKTDdSQ0VGU1BNTC9oTkxFQWxM
em93UnZDZWdlY2hhbHEvNkZZTUdtYmpLc1F4ODNaMS9JWGphOGJRUUx0Z09z
UgpLeUpNZDJFMDhicnpjV3pHbVJhY20zVHdaTUdxK2svSjZ0bWJUUThORk5M
UXhJS09qYWVhcXhTVHQyaU40RzdwCnBuU2c5NkdrMktUOEd3b1c2enIwTUJR
aFNVMzY2Q1JOZU1TeFJIYnBOWVVOM05YSXBYaVFuMmZSRFlqR1ROblc8L3hl
bmM6Q2lwaGVyVmFsdWU+PC94ZW5jOkNpcGhlckRhdGE+PC94ZW5jOkVuY3J5
cHRlZERhdGE+PC9zYW1sOkVuY3J5cHRlZEFzc2VydGlvbj48L3NhbWxwOlJl
c3BvbnNlPgoK';
	$secriyKey = 'MIICajCCAdOgAwIBAgIBADANBgkqhkiG9w0BAQ0FADBSMQswCQYDVQQGEwJ1czER
MA8GA1UECAwIbmV3IHlvcmsxFTATBgNVBAoMDHBhbGxhZGl1bWh1YjEZMBcGA1UE
AwwQcGFsbGFkaXVtaHViLmNvbTAeFw0yMTA1MTgxODQyMzdaFw0yMjA1MTgxODQy
MzdaMFIxCzAJBgNVBAYTAnVzMREwDwYDVQQIDAhuZXcgeW9yazEVMBMGA1UECgwM
cGFsbGFkaXVtaHViMRkwFwYDVQQDDBBwYWxsYWRpdW1odWIuY29tMIGfMA0GCSqG
SIb3DQEBAQUAA4GNADCBiQKBgQDfra7g+bwvhwbQeQErBlZd4g2sjN2BQMn45RJV
68zFHy21p+pKApdxcJ4dpslxuFvC8rqPU/do4msT2aA/8aPHFL4Tru+6JQL1cCji
UEJBkGJXNTwTlKDhvEV+thbOAL9ArqQUTtzPSce0MXC7LmOEE8MPm9MmrZPlR6Wl
g7cpWwIDAQABo1AwTjAdBgNVHQ4EFgQUkmOqXvxB6RopKmNYdkB3rna6WsYwHwYD
VR0jBBgwFoAUkmOqXvxB6RopKmNYdkB3rna6WsYwDAYDVR0TBAUwAwEB/zANBgkq
hkiG9w0BAQ0FAAOBgQCsHmAq3tHCTZbUFabJrKrC0CxM2jdzLgPE0/+N1YquPHjc
GV1yKseWfan8eF4EWdQLzR3Bj7TOxmezMLmFXIDUyhPiSxmU7gDO9vXMxI87gW4r
kQ9LOWjN6nerpmEzk04aiD50LX5E8LYX8bCutOqHN6VZzYA0betyvH/905SwAw==';

	//$keystring = base64_decode($encryptedString);

	$data = OneLogin_Saml2_Utils::decryptElement($keystring,$secriyKey,array()); //\DOMElement $encryptedData, \XMLSecurityKey $inputKey

	echo '<pre>'; 
	print_r($data); 
	exit;

	$settings = $auth->getSettings();
	$metadata = $settings->getSPMetadata();
	$errors = $settings->validateMetadata($metadata);
	if (empty($errors)) {
		header('Content-Type: text/xml');
		echo $metadata;
	} else {
		throw new OneLogin_Saml2_Error(
			'Invalid SP metadata: '.implode(', ', $errors),
		OneLogin_Saml2_Error::METADATA_SP_INVALID);
	}
} catch (Exception $e) {
	echo $e->getMessage();	
}